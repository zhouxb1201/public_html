webpackJsonp([28],{"BMk+":function(t,e){},EovM:function(t,e,n){"use strict";e.a=function(t){return Object(i.a)({url:"/addons/signin/signin/userSignInInfo",method:"post",data:t})},e.b=function(t){return Object(i.a)({url:"/addons/signin/signin/userSignInList",method:"post",data:t})},e.c=function(t){return Object(i.a)({url:"/addons/signin/signin/userSignInRecord",method:"post",data:t})},e.d=function(t){return Object(i.a)({url:"/addons/signin/signin/userSignIn",method:"post",data:t,isWriteIn:!0})};var i=n("vLgD")},Kwsh:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("eKM9"),a=n("EovM"),s=n("msXN"),r=Object(i.a)({name:"signin-log",data:function(){return{}},mixins:[s.e],computed:{},mounted:function(){this.$store.state.config.addons.signin?this.loadList():this.$refs.load.fail({errorText:"未开启签到应用",showFoot:!1})},methods:{loadList:function(t){var e=this;Object(a.c)(e.params).then(function(n){var i=n.data,a=i.data?i.data:[];e.pushToList(a,i.page_count,t)}).catch(function(){e.loadError()})}},components:{}}),o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"signin-log bg-f8"},[n("Navbar"),t._v(" "),n("List",{attrs:{finished:t.finished,error:t.error,"is-empty":t.isListEmpty},on:{"update:error":function(e){t.error=e},load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e,i){return n("van-cell",{key:i,attrs:{value:e.sign_in_time}},[n("div",{staticClass:"text",attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"positive"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"fs-12 text-regular"},[t._v("签到成功")])])])}))],1)},staticRenderFns:[]};var h=n("VU/8")(r,o,!1,function(t){n("BMk+")},"data-v-7a5f6520",null);e.default=h.exports},Qw1b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("eKM9"),a=n("EovM"),s=n("oFuF"),r=n("msXN"),o={data:function(){return{isLoading:!1}},props:{info:Object},mixins:[r.a],computed:{signinStateDisabled:function(){return!!this.info.is_signin},signinStateText:function(){return this.info.is_signin?"已签":"签到"}},methods:{onSignin:function(){var t=this;this.isLoading=!0,Object(a.d)().then(function(){t.info.is_signin=1,t.isLoading=!1,t.$emit("success",Object(s.m)((new Date).getTime()))}).catch(function(){t.isLoading=!1})}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"head card-group-box"},[n("img",{staticClass:"bg",attrs:{src:t.$BASEIMGPATH+"signin-head-bg.png"}}),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"info"},[n("div",{staticClass:"img"},[n("img",{attrs:{src:t._f("BASESRC")(t.info.user_headimg),onerror:t.$ERRORPIC.noAvatar}})]),t._v(" "),n("div",{staticClass:"text"},[n("div",{staticClass:"name"},[t._v(t._s(t.info.nick_name))]),t._v(" "),n("div",{staticClass:"name"},[t._v("\n          连续签到\n          "),n("span",{staticClass:"strong"},[t._v(t._s(t.info.continuous))])]),t._v(" "),n("router-link",{staticClass:"strong fs-12",attrs:{to:"/signin/log"}},[t._v("签到明细 >")])],1)]),t._v(" "),n("div",{staticClass:"btn-group flex-auto-center"},[n("van-button",{staticClass:"btn",attrs:{round:"",hairline:"",size:"small",loading:t.isLoading,disabled:t.signinStateDisabled},on:{click:function(e){t.bindMobile("onSignin")}}},[t._v(t._s(t.signinStateText))])],1)])])},staticRenderFns:[]};var u=n("VU/8")(o,h,!1,function(t){n("fm1A")},"data-v-30bf4382",null).exports,l=n("bOdI"),c=n.n(l),d=n("mvHQ"),f=n.n(d),m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",n={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours()%12==0?12:t.getHours()%12,"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var i in/(Y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+{0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"}[t.getDay()+""])),n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e};function v(t){return t<10?"0"+t:t}function g(t,e){return 0===e?{month:11,year:t-1}:{year:t,month:e-1}}function y(t,e){return 11===e?{month:0,year:t+1}:{year:t,month:e+1}}function p(t){return"number"==typeof t?t:"string"==typeof t?new Date(t.replace(/-/g,"/")).getTime():t.getTime()}function D(t,e,n,i,a){var s=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],i=arguments[3],a=new Date;a.setHours(0,0,0,0),t&&(n=n?Math.max(a.getTime(),p(n)):a);e&&(i=i?Math.min(a.getTime(),p(i)):a);return{start:n,end:i}}(e,n,i,a),r=s.start,o=s.end;t=p(t);var h=!r||t>=p(r),u=!o||t<=p(o);return h&&u}function w(t){var e=t.year,n=t.month,i=t.value,a=(t.rangeBegin,t.rangeEnd,t.returnSixRows),s=void 0===a||a,r=m(new Date,"YYYY-MM-DD"),o=function(t){var e=t.split("-");return{year:parseInt(e[0],10),month:parseInt(e[1],10)-1,day:parseInt(e[2],10)}}(i||r);("number"!=typeof e||"number"!=typeof n||n<0)&&(e=o.year,n=o.month);var h,u=new Date(e,n,1).getDay(),l=new Date(e,n+1,0).getDate(),c=new Date(e,n,0).getDate(),d=0,f=[];for(h=1;h<=l;h++){var v=new Date(e,n,h).getDay();if(0===v)f[d]=[];else if(1===h){f[d]=[];for(var p=c-u+1,D=0;D<u;D++){var w=g(e,n);f[d].push({year:w.year,month:w.month,month_str:w.month+1,day:p,isLastMonth:!0}),p++}}var b=m(new Date(e+"/"+(n+1)+"/"+h),"YYYY/MM/DD"),x={year:e,month:n,month_str:n+1,day:h,isCurrent:i&&m(new Date(i),"YYYY/MM/DD")===b,isToday:m(new Date,"YYYY/MM/DD")===b};if(f[d].push(x),6===v)d++;else if(h===l)for(var _=1;v<6;v++){var M=y(e,n);f[d].push({year:M.year,month:M.month,month_str:M.month+1,day:_,isNextMonth:!0}),_++}}if(s&&5===f.length){var C=y(e,n),V=f[4][6].isNextMonth?f[4][6].day:0;f[5]=[];for(var k=0;k<7;k++){var L=++V;f[5].push({year:C.year,month:C.month,month_str:C.month+1,day:L,isNextMonth:!0})}}if(s&&4===f.length){var T=y(e,n),S=0;f[4]=[],f[5]=[];for(var Y=0;Y<7;Y++){var O=++S;f[4].push({year:T.year,month:T.month,month_str:T.month+1,day:O,isNextMonth:!0}),O=++S,f[5].push({year:T.year,month:T.month,month_str:T.month+1,day:O,isNextMonth:!0})}}return{year:e,month:n,month_str:n+1,days:f.map(function(t){return t.map(function(t,e){return t.date=t.day,t.weekDay=e,t.isWeekend=0===e||6===e,t.formatedDate=m(new Date(t.year+"/"+t.month_str+"/"+t.date),"YYYY-MM-DD"),t}),t})}}var b={name:"inline-calendar",mixins:[{methods:{isShowBottomDot:function(t){if(this.marks.length){var e=this.marks.filter(function(e){return e.date===t.formatedDate});return!(!e.length||!e[0].bottomDot)}},isShowTopTip:function(t,e){if(this.marks.length){var n=this.marks.filter(function(e){return e.date===t.formatedDate});if(n.length){var i=n[0];if(i.topTip)return"style"===e?{color:i.topTip.color}:"text"!==e||i.topTip.text}return!1}},getMarkStyle:function(t){if(this.marks.length){var e=this.marks.filter(function(e){return e.date===t.formatedDate}),n=t.formatedDate===this.currentValue;return e.length?{backgroundColor:n?"":e[0].backgroundColor,color:n?"":e[0].color,border:n?"":e[0].border}:void 0}}}}],props:{value:{type:[String,Array],default:""},renderMonth:{type:Array,default:function(){return[null,null]}},startDate:{type:String},endDate:{type:String},showLastMonth:{type:Boolean,default:!0},showNextMonth:{type:Boolean,default:!0},highlightWeekend:{type:Boolean,default:!1},returnSixRows:{type:Boolean,default:!0},hideHeader:{type:Boolean,default:!1},hideWeekList:{type:Boolean,default:!1},replaceTextList:{type:Object,default:function(){return{}}},weeksList:{type:Array,validator:function(t){return!t||7===t.length||0===t.length}},renderFunction:{type:Function,default:function(){return""}},renderOnValueChange:{type:Boolean,default:!0},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},disableWeekend:{type:Boolean,default:!1},disableSelect:{type:Boolean,default:!1},disableDateFunction:Function,marks:{type:Array,default:function(){return[]}}},data:function(){return{multi:!1,year:0,month:0,days:[],today:m(new Date,"YYYY-MM-DD"),months:["1","2","3","4","5","6","7","8","9","10","11","12"],currentValue:"",viewChangeEventCount:-1}},created:function(){if(this.currentValue=this.value,this.multi="[object Array]"===Object.prototype.toString.call(this.currentValue),this.multi)for(var t=0;t<this.currentValue.length;t++)this.$set(this.currentValue,t,this.convertDate(this.currentValue[t]));else this.currentValue=this.convertDate(this.currentValue);this.render(this.renderMonth[0],this.renderMonth[1]-1)},computed:{_weeksList:function(){return this.weeksList&&this.weeksList.length?this.weeksList:this.weeksList&&this.weeksList.length?void 0:["日","一","二","三","四","五","六"]},_replaceTextList:function(){var t={};for(var e in this.replaceTextList)t[this.convertDate(e)]=this.replaceTextList[e];return t},currentYearMonth:function(){return this.year+this.month}},watch:{value:function(t){this.currentValue=this.multi?t:this.convertDate(t)},currentValue:function(t,e){if(this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue),this.renderOnValueChange){if(t&&e&&t.slice(0,7)===e.slice(0,7))return;this.render(null,null,"value change")}},renderFunction:function(){this.render(this.year,this.month,this.currentValue)},renderMonth:function(t){t&&2===t.length&&this.render(t[0],t[1]-1)},returnSixRows:function(t){this.render(this.year,this.month)},startDate:function(t){this.render(this.year,this.month)},endDate:function(t){this.render(this.year,this.month)},disablePast:function(){this.render(this.year,this.month)},disableFuture:function(){this.render(this.year,this.month)},currentYearMonth:function(){var t=this.days[this.days.length-1],e=t[t.length-1],n=[];this.days.forEach(function(t){n=n.concat(t)}),n=n.filter(function(t){return!t.isLastMonth&&!t.isNextMonth}),this.viewChangeEventCount++,this.$emit("on-view-change",{year:this.year,month:this.month+1,firstDate:this.days[0][0].formatedDate,lastDate:e.formatedDate,firstCurrentMonthDate:n[0].formatedDate,lastCurrentMonthDate:n[n.length-1].formatedDate,allDates:this.days},this.viewChangeEventCount)}},methods:{processDateItem:function(t){var e=JSON.parse(f()(t));return e.isDisabled=this.isDisabled(t),e.isBetween=this.isBetween(t.formatedDate),e},isBetween:function(t){return D(t,this.disablePast,this.disableFuture,this.startDate,this.endDate)},isDisabled:function(t){var e=!this.isBetween(t.formatedDate);if(e=(e=e||t.isWeekend&&this.disableWeekend)||t.isNextMonth||t.isLastMonth,this.disableDateFunction){var n=this.disableDateFunction(t);return void 0===n?e:n}return e},switchViewToToday:function(){var t=new Date;this.render(t.getFullYear(),t.getMonth())},switchViewToCurrentValue:function(){if(this.currentValue&&(!this.multi||this.currentValue.length)){var t,e,n=("string"==typeof this.currentValue?this.currentValue:this.currentValue[0]).split("-");t=parseInt(n[0],10),e=parseInt(n[1],10),this.switchViewToMonth(t,e)}},switchViewToMonth:function(t,e){if(!t||!e)return this.switchViewToToday();this.render(t,e-1)},getDates:function(){return this.days},replaceText:function(t,e){var n=this._replaceTextList[e];return n||void 0!==n?n:t},convertDate:function(t){return"TODAY"===t?this.today:t},buildClass:function(t,e){var n=!1;return e.isLastMonth||e.isNextMonth||(n=this.multi&&this.currentValue.length>0?this.currentValue.indexOf(this.formatDate(this.year,this.month,e))>-1:this.currentValue===this.formatDate(this.year,this.month,e)),c()({current:n,"is-disabled":this.isDisabled(e),"is-today":e.isToday},"is-week-"+t,!0)},render:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=w({year:t,month:e,value:this.multi?this.currentValue[this.currentValue.length-1]:this.currentValue,rangeBegin:this.convertDate(this.startDate),rangeEnd:this.convertDate(this.endDate),returnSixRows:this.returnSixRows,disablePast:this.disablePast,disableFuture:this.disableFuture}),(this.year!==n.year||this.month!==n.month||i)&&(this.year=n.year,this.month=n.month,this.days=n.days)},formatDate:function(t,e,n){return[t,v(n.month+1),v(n.day)].join("-")},prev:function(){0===this.month?(this.month=11,this.year=this.year-1):this.month=this.month-1,this.render(this.year,this.month,!0)},next:function(){11===this.month?(this.month=0,this.year=this.year+1):this.month=this.month+1,this.render(this.year,this.month,!0)},go:function(t,e){this.render(t,e,!0)},select:function(t,e,n){if(!this.disableSelect&&(!n.isLastMonth||this.showLastMonth)&&(!n.isNextMonth||this.showNextMonth)&&this.isBetween(n.formatedDate)){if(this.isDisabled(n)){if(!this.isBetween(n.formatedDate))return;if(this.disableDateFunction&&this.disableDateFunction(n))return;if(n.isWeekend&&this.disableWeekend)return}var i=null;if(n.isLastMonth||n.isNextMonth?i=[n.year,v(n.month+1),v(n.day)].join("-"):(this.days[t][e].current=!0,i=[this.year,v(this.month+1),v(this.days[t][e].day)].join("-")),this.multi){var a=this.currentValue.indexOf(i);a>-1?this.currentValue.splice(a,1):this.currentValue.push(i)}else this.currentValue=i,this.$emit("on-select-single-date",this.currentValue);if(this.multi)for(var s=0;s<this.currentValue.length;s++)this.$set(this.currentValue,s,this.convertDate(this.currentValue[s]));else this.currentValue=this.convertDate(this.currentValue);this.renderOnValueChange&&this.render(null,null)}},showChild:function(t,e,n){return!!this.replaceText(n.day,this.formatDate(t,e,n))&&(!n.isLastMonth&&!n.isNextMonth||n.isLastMonth&&this.showLastMonth||n.isNextMonth&&this.showNextMonth)}}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inline-calendar",class:{"is-weekend-highlight":t.highlightWeekend}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hideHeader,expression:"!hideHeader"}],staticClass:"calendar-header"},[n("div",{staticClass:"calendar-year"},[n("span",{on:{click:function(e){t.go(t.year-1,t.month)}}},[n("a",{staticClass:"year-prev vux-prev-icon",attrs:{href:"javascript:"}})]),t._v(" "),n("a",{staticClass:"calendar-year-txt calendar-title",attrs:{href:"javascript:"}},[t._v(t._s(t.year))]),t._v(" "),n("span",{staticClass:"calendar-header-right-arrow",on:{click:function(e){t.go(t.year+1,t.month)}}},[n("a",{staticClass:"year-next vux-next-icon",attrs:{href:"javascript:"}})])]),t._v(" "),n("div",{staticClass:"calendar-month"},[n("span",{on:{click:t.prev}},[n("a",{staticClass:"month-prev vux-prev-icon",attrs:{href:"javascript:"}})]),t._v(" "),n("a",{staticClass:"calendar-month-txt calendar-title",attrs:{href:"javascript:"}},[t._v(t._s(t.months[t.month]))]),t._v(" "),n("span",{staticClass:"calendar-header-right-arrow",on:{click:t.next}},[n("a",{staticClass:"month-next vux-next-icon",attrs:{href:"javascript:"}})])])]),t._v(" "),n("table",[n("thead",{directives:[{name:"show",rawName:"v-show",value:!t.hideWeekList,expression:"!hideWeekList"}]},[n("tr",t._l(t._weeksList,function(e,i){return n("th",{staticClass:"week",class:"is-week-list-"+i},[t._v(t._s(e))])}))]),t._v(" "),n("tbody",t._l(t.days,function(e,i){return n("tr",t._l(e,function(e,a){return n("td",{class:t.buildClass(a,e),attrs:{"data-date":t.formatDate(t.year,t.month,e),"data-current":t.currentValue},on:{click:function(n){t.select(i,a,e)}}},[t._t("each-day",[n("span",{directives:[{name:"show",rawName:"v-show",value:t.showChild(t.year,t.month,e),expression:"showChild(year, month, child)"}],staticClass:"vux-calendar-each-date",style:t.getMarkStyle(e)},[n("span",{staticClass:"vux-calendar-each-date-text"},[t._v(t._s(t.replaceText(e.day,t.formatDate(t.year,t.month,e))))]),t._v(" "),t.isShowTopTip(e)?n("span",{staticClass:"vux-calendar-top-tip",style:t.isShowTopTip(e,"style")},[n("span",[t._v(t._s(t.isShowTopTip(e,"text")))])]):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showChild(t.year,t.month,e),expression:"showChild(year, month, child)"}],domProps:{innerHTML:t._s(t.renderFunction(i,a,e))}})]),t._v(" "),t.isShowBottomDot(e)?n("span",{staticClass:"vux-calendar-dot"}):t._e()],{year:t.year,month:t.month,child:t.processDateItem(e),date:t.processDateItem(e),className:"vux-calendar-each-date",row:i,col:a,rawDate:t.formatDate(t.year,t.month,e),showDate:t.replaceText(e.day,t.formatDate(t.year,t.month,e)),isShow:t.showChild(t.year,t.month,e)})],2)}))}))])])},staticRenderFns:[]};var _=n("VU/8")(b,x,!1,function(t){n("mmOl")},null,null).exports,M=Object(i.a)({name:"signin",data:function(){return{info:{},signinList:[]}},mounted:function(){this.$store.state.config.addons.signin?this.loadData():this.$refs.load.fail({errorText:"未开启签到应用",showFoot:!1})},methods:{loadData:function(){var t=this;Object(a.a)().then(function(e){var n=e.data;t.info=n,t.$refs.load.success()})},buildSlotFn:function(t,e,n){return-1!=this.signinList.indexOf(n.formatedDate)?'<small class="calendar-small"><i class="van-icon van-icon-v-icon-success3"/>已签</small>':""},onChange:function(t){var e=t.firstCurrentMonthDate;this.getSigninList(e)},getSigninList:function(t){var e=this;Object(a.b)({time:t}).then(function(t){t.data.forEach(function(t){var n=t.sign_in_time;e.signinList.push(Object(s.m)(n))})})}},components:{Header:u,InlineCalendar:_}}),C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("Layout",{ref:"load",staticClass:"signin"},[e("Navbar"),this._v(" "),e("Header",{attrs:{info:this.info},on:{success:this.getSigninList}}),this._v(" "),e("InlineCalendar",{ref:"calendar",attrs:{"disable-select":"",renderFunction:this.buildSlotFn},on:{"on-view-change":this.onChange}})],1)},staticRenderFns:[]};var V=n("VU/8")(M,C,!1,function(t){n("v8gC")},"data-v-14b88d2c",null);e.default=V.exports},fm1A:function(t,e){},mmOl:function(t,e){},v8gC:function(t,e){}});