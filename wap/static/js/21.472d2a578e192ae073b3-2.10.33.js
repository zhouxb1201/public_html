webpackJsonp([21],{"2DBI":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("eKM9"),i=e("dj2u"),r=e("mvHQ"),n=e.n(r),o=e("BuIE"),c={props:{items:[Object,Array]},computed:{defaultImg:function(t){var s=null,e=this.$BASEIMGPATH;return function(t){return t&&(1==t?s='this.src="'+e+'default-balance.png"':2==t?s='this.src="'+e+'default-integral.png"':3==t?s='this.src="'+e+'default-coupon.png"':4==t?s='this.src="'+e+'default-giftvoucher.png"':5==t?s='this.src="'+e+'default-goods.png"':6==t&&(s='this.src="'+e+'default-gift.png"')),s}}},methods:{onConfirm:function(){var t={};t.member_prize_id=this.items.member_prize_id,this.$router.push({name:"prize-confirm",query:{params:Object(o.b)(n()(t))}})},onLogistics:function(){var t=this.items.receive_id;this.$router.push({name:"order-logistics",params:{orderid:t}})}}},d={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"card card-group-box"},[e("div",{staticClass:"card__header"},[e("div",{staticClass:"card__head__left"},[e("div",{staticClass:"card__img"},[e("img",{attrs:{src:t.items.pic,onerror:t.defaultImg(t.items.type)}})]),t._v(" "),e("div",{staticClass:"card__goods__info"},[e("div",[t._v(t._s(t.items.prize_name))]),t._v(" "),e("div",[t._v(t._s(t.items.activity_name))])])]),t._v(" "),e("div",{staticClass:"card__head__right"},[t._v("【"+t._s(t.items.term_name)+"】")])]),t._v(" "),e("div",{staticClass:"card__content"},[e("div",{staticClass:"w50 time"},[t._v(t._s(t._f("formatDate")(t.items.expire_time,"s"))+"过期")]),t._v(" "),1==t.items.state?e("div",{staticClass:"w50 btn"},[e("van-button",{attrs:{plain:"",type:"danger"},on:{click:t.onConfirm}},[t._v("领奖")])],1):2==t.items.state?e("div",{staticClass:"w50 btn"},[5==t.items.type?e("van-button",{attrs:{plain:"",type:"primary"},on:{click:t.onLogistics}},[t._v("物流")]):t._e()],1):3==t.items.state?e("div",{staticClass:"w50 btn"},[e("van-button",{staticClass:"back",attrs:{plain:"",type:"danger",disabled:""}},[t._v("已过期")])],1):t._e()])])},staticRenderFns:[]};var l=e("VU/8")(c,d,!1,function(t){e("g7T9")},"data-v-1b4b4ec5",null).exports,u=e("ORU3"),_=e("msXN"),f=Object(a.a)({name:"prize-list",data:function(){return{tab_active:0,tabs:[{name:"未领奖",state:1},{name:"已领奖",state:2},{name:"已过期",state:3}],params:{state:1,page_index:1,page_size:10}}},mixins:[_.e],mounted:function(){this.loadList()},methods:{onTab:function(t){var s=this.tabs[t].state;this.params.state=s,this.loadList("init")},loadList:function(t){var s=this;t&&"init"===t&&s.initList(),Object(i.c)(s.params).then(function(e){var a=e.data,i=a.data;s.pushToList(i,a.page_count,t)})}},components:{Card:l,HeadTab:u.a}}),p={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"prize-list bg-f8"},[e("Navbar",{attrs:{isMenu:!1}}),t._v(" "),e("HeadTab",{attrs:{tabs:t.tabs},on:{"tab-change":t.onTab},model:{value:t.tab_active,callback:function(s){t.tab_active=s},expression:"tab_active"}}),t._v(" "),e("List",{staticClass:"list",attrs:{finished:t.finished,error:t.error,"is-empty":t.isListEmpty,empty:{pageType:"goods",top:t.$store.state.isWeixin?46:90,message:"没有相关奖品"}},on:{"update:error":function(s){t.error=s},load:t.loadList},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},t._l(t.list,function(t,s){return e("Card",{key:s,attrs:{items:t}})}))],1)},staticRenderFns:[]};var v=e("VU/8")(f,p,!1,function(t){e("RiFG")},"data-v-0b6e9fc6",null);s.default=v.exports},Dt2E:function(t,s){},IUTc:function(t,s){},RiFG:function(t,s){},X7oW:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("eKM9"),i=e("R5/C"),r=Object(a.a)({name:"prize-result",data:function(){return{isShare:!1}},methods:{closeShare:function(){this.isShare=!1},openShare:function(){this.$store.state.isWeixin?this.isShare=!0:this.$Toast("请点击下方工具栏“分享”按钮进行分享")},onBack:function(){this.$router.replace({name:"prize-list"})}},components:{PopupShare:i.a}}),n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{ref:"load",staticClass:"prize-result bg-f8"},[e("Navbar",{attrs:{isMenu:!1,isShowLeft:!1}}),t._v(" "),e("h3",{staticClass:"success-txt"},[t._v("恭喜你，奖品已收入囊中！")]),t._v(" "),e("div",{staticClass:"img"},[e("img",{attrs:{src:t.$BASEIMGPATH+"prize-success.png"}})]),t._v(" "),e("van-row",{staticClass:"btn-wrap",attrs:{type:"flex",justify:"center"}},[e("van-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(s){return t.openShare(s)}}},[t._v("嘚瑟一下")]),t._v(" "),e("van-button",{attrs:{type:"danger",size:"small"},on:{click:t.onBack}},[t._v("完成")])],1),t._v(" "),e("PopupShare",{attrs:{isShow:t.isShare},nativeOn:{click:function(s){return t.closeShare(s)}}})],1)},staticRenderFns:[]};var o=e("VU/8")(r,n,!1,function(t){e("Dt2E")},"data-v-71c05f4e",null);s.default=o.exports},dj2u:function(t,s,e){"use strict";s.c=function(t){return Object(a.a)({url:"/member/myPrize",method:"post",data:t})},s.b=function(t){return Object(a.a)({url:"/member/prizeDetail",method:"post",data:t,isWriteIn:!0})},s.a=function(t){return Object(a.a)({url:"/member/acceptPrize",method:"post",data:t,isWriteIn:!0})};var a=e("vLgD")},g7T9:function(t,s){},hcgN:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("//Fk"),i=e.n(a),r=e("eKM9"),n=e("OQ2V"),o=e("m3LI"),c=e("dj2u"),d=e("oFuF"),l=e("BuIE"),u=Object(r.a)({name:"prize-confirm",data:function(){JSON.parse(Object(l.a)(this.$route.query.params));return{address:{},type:null,items:{},flag:!0,store_show:!1,goods_type:null,store_list:[],storeInfo:{}}},computed:{params:{get:function(){return JSON.parse(Object(l.a)(this.$route.query.params))},set:function(t){console.log(t)}},defaultImg:function(t){var s=null,e=this.$BASEIMGPATH;return function(t){return t&&(1==t?s='this.src="'+e+'default-balance.png"':2==t?s='this.src="'+e+'default-integral.png"':3==t?s='this.src="'+e+'default-coupon.png"':4==t?s='this.src="'+e+'default-giftvoucher.png"':5==t?s='this.src="'+e+'default-goods.png"':6==t&&(s='this.src="'+e+'default-gift.png"')),s}},isOfflineGoods:function(){var t=!1;return 5==this.type&&0==this.goodsType&&(t=!0),t}},mounted:function(){var t=this;this.getLocation().then(function(){t.loadData()})},methods:{getLocation:function(){var t=this;return new i.a(function(s,e){t.$store.dispatch("getBMapLocation").then(function(e){var a=e.location;t.params.lng=a.lng,t.params.lat=a.lat,s()}).catch(function(e){t.$Toast(e),s()})})},loadData:function(){var t=this;Object(c.b)(t.params).then(function(s){var e=s.data;t.items=e,t.type=e.type,t.goods_type=e.goods_type,Object(d.s)(e.address)||(t.address={name:e.address.consigner,tel:e.address.mobile,id:e.address.address_id,address:e.address.province_name+e.address.city_name+e.address.district_name+e.address.address_detail}),Object(d.s)(e.store_list)||(t.store_list=e.store_list),t.$refs.load.success()})},onAddress:function(t){this.address=t,this.params.address_id=t.id,this.loadData()},onReceive:function(){var t=this;if(!this.flag)return!1;this.flag=!1;var s={};if(s.member_prize_id=this.items.member_prize_id,s.order_from=this.$store.state.isWeixin&&this.$store.getters.config.is_wchat?1:2,5==this.type&&1==this.goods_type||6==this.type){if(s.address_id=this.items.address.address_id,!s.address_id)return this.flag=!0,this.$Toast("请选择收货地址!")}else if(5==this.type&&0==this.goods_type&&(s.card_store_id=this.storeInfo.card_store_id?this.storeInfo.card_store_id:this.storeInfo.store_id,!s.card_store_id))return this.flag=!0,this.$Toast("请选择门店!");Object(c.a)(s).then(function(s){1==s.code&&t.$router.replace({name:"prize-result"})}).catch(function(){})},onPopupStore:function(){this.store_show=!0},onStore:function(t){var s=t.lat,e=t.lng,a=t.shop_id,i=t.store_id,r=t.store_name;this.params.lng=e,this.params.lat=s,this.items.shop_id==a&&(this.isOfflineGoods?this.storeInfo.card_store_id=i:this.storeInfo.store_id=i,this.storeInfo.store_name=r,this.storeInfo.shop_id=a),this.loadData()}},components:{ChoiceAddress:n.a,PopupStore:o.a}}),_={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("Layout",{ref:"load",staticClass:"prize-confirm bg-f8"},[e("Navbar",{attrs:{isMenu:!1}}),t._v(" "),5==t.type&&1==t.goods_type||6==t.type?e("ChoiceAddress",{attrs:{address:t.address},on:{select:t.onAddress}}):t._e(),t._v(" "),5==t.type&&0==t.goods_type?e("div",{staticClass:"store-wrap",on:{click:t.onPopupStore}},[t.storeInfo.store_name?e("van-cell",{staticClass:"card-bottom-bg",attrs:{border:"",center:"","is-link":""}},[e("div",{staticClass:"store-info"},[e("van-col",{attrs:{span:"14"}},[t._v("使用门店")]),t._v(" "),e("van-col",{staticClass:"text-right",attrs:{span:"10"}},[t._v(t._s(t.storeInfo.store_name||""))])],1)]):e("van-cell",{staticClass:"card-bottom-bg",attrs:{border:"",center:"","is-link":"",icon:"add"}},[e("div",{staticClass:"store-info"},[t._v("添加门店")])])],1):t._e(),t._v(" "),e("div",{staticClass:"confrim-wrap"},[e("div",{staticClass:"confrim-left"},[e("div",{staticClass:"img"},[e("img",{attrs:{src:t.items.pic,onerror:t.defaultImg(t.items.type)}})]),t._v(" "),e("div",{staticClass:"confrim-goods-info"},[e("div",[t._v(t._s(t.items.prize_name))]),t._v(" "),e("div",[t._v(t._s(t.items.name))])])]),t._v(" "),e("div",{staticClass:"confrim-right"},[t._v("x1")])]),t._v(" "),e("div",{staticClass:"fixed-foot-btn-group"},[e("van-button",{attrs:{size:"normal",type:"danger",round:"",block:""},on:{click:t.onReceive}},[t._v("立即领取")])],1),t._v(" "),t.$store.state.config.addons.store?e("PopupStore",{attrs:{store_id:t.storeInfo.store_id||t.storeInfo.card_store_id,list:t.store_list||[]},on:{select:t.onStore},model:{value:t.store_show,callback:function(s){t.store_show=s},expression:"store_show"}}):t._e()],1)},staticRenderFns:[]};var f=e("VU/8")(u,_,!1,function(t){e("IUTc")},"data-v-4a490755",null);s.default=f.exports},m3LI:function(t,s,e){"use strict";var a=e("JLLx"),i={data:function(){return{}},props:{value:{type:Boolean,default:!1},store_id:[String,Number],list:Array},filters:{distance:function(t){return t+"km"}},computed:{show:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},active:{get:function(){return this.store_id&&Number(this.store_id)},set:function(t){}}},methods:{close:function(){this.$emit("input",!1)},select:function(t){this.$emit("select",t),this.close()}},components:{PopupBottom:a.a}},r={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("PopupBottom",{attrs:{fullScreen:"",showFootClose:""},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[e("van-radio-group",{staticClass:"list",model:{value:t.active,callback:function(s){t.active=s},expression:"active"}},[e("van-cell-group",{attrs:{border:!1}},t._l(t.list,function(s,a){return e("van-cell",{key:a,attrs:{clickable:""}},[e("van-radio",{staticClass:"item",attrs:{name:s.store_id},on:{click:function(e){t.select(s)}}},[e("div",{staticClass:"info"},[e("div",{staticClass:"name"},[e("van-col",{attrs:{span:"18"}},[t._v(t._s(s.store_name))]),t._v(" "),e("van-col",{staticClass:"distance",attrs:{span:"6"}},[t._v(t._s(t._f("distance")(s.distance)))])],1),t._v(" "),e("div",{staticClass:"detail"},[e("van-col",{attrs:{span:"24"}},[t._v(t._s(s.province_name+s.city_name+s.dictrict_name+s.address))])],1)])])],1)}))],1)],1)},staticRenderFns:[]};var n=e("VU/8")(i,r,!1,function(t){e("vvrX")},"data-v-4eaf9136",null);s.a=n.exports},vvrX:function(t,s){}});