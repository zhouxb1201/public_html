webpackJsonp([12],{"/0o8":function(t,e){},"0Qt4":function(t,e){},"41Nh":function(t,e){},CjYO:function(t,e){},E2ca:function(t,e){},FSmk:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("eKM9"),i=s("u3Bc"),o={data:function(){return{tab:[{name:"默认",sort:""},{name:"兑换量",icon:"v-icon-sort2",sort:"sales",sort_type:"DESC"},{name:this.$store.state.member.memberSetText.point_style,icon:"v-icon-sort2",sort:"point_exchange",sort_type:"DESC"}],params:{page_index:1,page_size:10,order:"",sort:"",search_text:this.$route.query.search_text?this.$route.query.search_text:"",category_id:this.$route.query.category_id?this.$route.query.category_id:"",shop_id:this.$route.query.shop_id?this.$route.query.shop_id:""}}},props:{setParams:{type:Function,default:null}},methods:{onSort:function(t){var e=this.$parent.params;e.page_index=1,e.order=this.tab[t].sort,this.tab[t].sort_type?(e.sort=this.tab[t].sort_type,"DESC"==this.tab[t].sort_type?this.tab[t].sort_type="ASC":this.tab[t].sort_type="DESC"):e.sort="",this.setParams&&this.setParams(e,"init")}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tab-sort-screen"},[s("van-tabs",{on:{click:t.onSort}},t._l(t.tab,function(e,a){return s("van-tab",{key:a,attrs:{disabled:!1===e.sort}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n        "+t._s(e.name)+"\n        "),e.icon?s("van-icon",{attrs:{name:e.icon+" "+e.sort_type}}):t._e()],1)])}))],1)},staticRenderFns:[]};var r=s("VU/8")(o,n,!1,function(t){s("aLJN")},"data-v-2673cda2",null).exports,c=s("p+v9"),d=s("msXN"),u=Object(a.a)({name:"integral-goods-list",data:function(){return{params:{order:"",sort:"",search_text:this.$route.query.search_text?this.$route.query.search_text:"",category_id:this.$route.query.category_id?this.$route.query.category_id:"",shop_id:this.$route.query.shop_id?this.$route.query.shop_id:""}}},mixins:[d.e],computed:{navBarTitle:function(){var t=this.$route.query,e=this.$route.meta.title;return t.search_text?e="搜索："+t.search_text:t.text&&(e=t.text),e&&(document.title=e),e}},watch:{"$route.query":function(t){var e=t.category_id,s=t.search_text;"integral-goods-list"===this.$route.name&&(void 0==e&&void 0==s?(this.params.category_id="",this.params.search_text="",this.loadList("init")):e?(this.params.category_id=e,this.params.search_text="",this.loadList("init")):s&&(this.params.category_id="",this.params.search_text=s,this.loadList("init")))}},mounted:function(){this.loadList()},methods:{loadList:function(t){var e=this;Object(c.c)(e.params).then(function(s){var a=s.data,i=a.goods_list;e.pushToList(i,a.page_count,t)}).catch(function(){e.loadError()})},setParams:function(t){this.params=t,this.loadList("init")}},components:{TabSortScreen:r,GoodsTab:i.a}}),l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"integral-goods-list bg-f8"},[s("Navbar",{attrs:{title:t.navBarTitle}}),t._v(" "),s("TabSortScreen",{attrs:{"set-params":t.setParams}}),t._v(" "),s("List",{attrs:{finished:t.finished,error:t.error,"is-empty":t.isListEmpty,empty:{pageType:"integralgoods",message:"暂无商品",showFoot:!0,btnLink:"/integral/index",btnText:"返回积分商城"}},on:{"update:error":function(e){t.error=e},load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"list"},t._l(t.list,function(t,e){return s("GoodsTab",{key:e,attrs:{id:t.goods_id,gtype:t.type,exchange:t.point_exchange,sales:t.point_exchange,name:t.goods_name,image:t.logo,price:t.price}})}))])],1)},staticRenderFns:[]};var _=s("VU/8")(u,l,!1,function(t){s("sJM5")},"data-v-52709911",null);e.default=_.exports},GmJi:function(t,e){},KQVV:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("eKM9"),i=s("WyhY"),o=s("p+v9"),n=Object(a.a)({name:"integral-category",data:function(){return{items:[]}},activated:function(){var t=this;Object(o.a)().then(function(e){t.items=e.data,t.$refs.load.success()}).catch(function(){$this.$refs.load.fail()})},methods:{toList:function(t,e){this.$router.push({path:"/integral/goods/list",query:{category_id:t,text:e}})}},components:{HeadSearch:i.a}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Layout",{ref:"load",staticClass:"integral-category"},[s("HeadSearch",{attrs:{searchType:"integralgoods"}}),t._v(" "),s("div",{staticClass:"category-view"},[s("section",{staticClass:"category"},[s("div",{staticClass:"content"},[s("div",{staticClass:"item"},t._l(t.items,function(e,a){return s("div",{key:a,staticClass:"item-child"},[s("div",{staticClass:"item-box e-handle",on:{click:function(s){t.toList(e.category_id,e.short_name?e.short_name:e.category_name)}}},[s("div",{staticClass:"images"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.category_pic,expression:"item.category_pic"}],key:e.category_pic,attrs:{"pic-type":"square"}})]),t._v(" "),s("div",{staticClass:"name"},[t._v(t._s(e.short_name?e.short_name:e.category_name))])])])}))])])])],1)},staticRenderFns:[]};var c=s("VU/8")(n,r,!1,function(t){s("/0o8")},"data-v-cd13e168",null);e.default=c.exports},KX41:function(t,e){},Meda:function(t,e,s){"use strict";var a=s("nsZj"),i=(s.n(a),s("P8PS"));s.n(i)},P8PS:function(t,e){},R47m:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("bOdI"),i=s.n(a),o=(s("Meda"),s("e89B")),n=(s("nsZj"),s("41Nh"),s("WPoX")),r=s("AA6R"),c=s.n(r),d=s("o69Z"),u=s("SSsa"),l=s("rhik"),_=s("n8HW"),p=Object(d.k)("goods-action-big-btn"),h=p[0],m=p[1];function g(t,e,s,a){return t(u.a,c()([{attrs:{square:!0,size:"large",loading:e.loading,disabled:e.disabled,type:e.primary?"danger":"warning"},class:m(),on:{click:function(t){Object(l.a)(a,"click",t),Object(_.a)(a)}}},Object(l.b)(a)]),[s.default?s.default():e.text])}g.props=Object(n.a)({},_.c,{text:String,primary:Boolean,loading:Boolean,disabled:Boolean});var v=h(g),f=(s("zTEI"),s("pzvz")),b=(s("VlKy"),s("VFiq")),y=(s("zP7x"),s("rD0v")),k=(s("3AsM"),s("7ZPY")),x=s("mvHQ"),C=s.n(x),S=s("eKM9"),$={data:function(){return{}},props:{descript:String}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"descript"},[this.descript?e("div",{staticClass:"richtext",domProps:{innerHTML:this._s(this.descript)}}):e("div",{staticClass:"empty"},[this._v("暂无详情")])])},staticRenderFns:[]};var O=s("VU/8")($,T,!1,function(t){s("mZBS")},"data-v-72d764ef",null).exports,j={data:function(){return{}},props:{attribute:Array}},P={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"attribute"},[t.attribute.length>0?s("van-cell-group",t._l(t.attribute,function(e,a){return s("van-cell",{key:a},[s("van-col",{attrs:{span:"8"}},[t._v(t._s(e.attr_value))]),t._v(" "),s("van-col",{attrs:{span:"16"}},[t._v(t._s(e.attr_value_name))])],1)})):s("div",{staticClass:"empty"},[t._v("暂无属性")])],1)},staticRenderFns:[]};var q,E=s("VU/8")(j,P,!1,function(t){s("GmJi")},"data-v-328c7431",null).exports,N=s("R5/C"),L=s("p+v9"),w=s("oFuF"),B=s("BuIE"),R=s("msXN"),F=Object(S.a)({name:"integral-goods-detail",data:function(){return{tab_active:0,tabs:[{name:"详情",type:"Descript"},{name:"属性",type:"Attribute"}],goods_detail:{},sku_selectedComb:null,sku_selectedNum:1,goodsSku:{},showSku:!1,goodsInfo:{},isShare:!1}},mixins:[R.a],computed:{pointText:function(){return this.$store.state.member.memberSetText.point_style},shareBtnStyle:function(){return{top:"15px",position:"absolute"}},goodsid:function(){return this.$route.params.goodsid},navBarTitle:function(){var t=this.goods_detail.goods_name;return t&&(document.title=t),t},maxHeight:function(){return{maxHeight:document.body.offsetWidth+"px"}},goods_state:function(){var t=null,e=this.sku_selectedComb?this.sku_selectedComb.point_exchange:this.goods_detail.point_exchange;return this.goods_detail&&this.goods_detail.state?t=0==this.countStock?-1:this.goods_detail.member_point<e?-2:this.goods_detail.state:0==this.goods_detail.state&&(t=0),t},goods_state_text:function(){return-1==this.goods_state?"商品已售罄":-2==this.goods_state?"积分不足":"商品已下架"},goodsPrice:function(){return parseFloat(this.sku_selectedComb?this.sku_selectedComb.price/100:this.goodsSku.price)},goodsPoint:function(){return(this.sku_selectedComb?this.sku_selectedComb.point_exchange:this.goods_detail.point_exchange)+this.pointText},tranList:function(){var t=this.goods_detail.sku.list;return t.forEach(function(t){t.price=100*parseFloat(t.price)}),t},countStock:function(){var t=this.goods_detail.sku?this.goods_detail.sku.list:[],e=0;return t&&!Object(w.s)(t)&&t.forEach(function(t){e+=parseInt(t.stock_num)}),e},sku_selectedText:function(){return this.goodsSku.none_sku?"已选："+this.sku_selectedNum:this.sku_selectedComb?"已选："+this.sku_selectedComb.sku_name:"请选择规格"},quota:function(){var t=Object(w.s)(this.goodsSku)?null:this.goodsSku,e=this.sku_selectedComb,s=-1;return t&&(!t.none_sku&&e?s=e.max_buy:t.none_sku&&(s=t.list[0].max_buy)),s},customStepperConfig:function(){var t=this;-1==t.quota||t.quota;return{handleOverLimit:function(e){var s=e.action,a=e.limitType,i=e.quota;e.quotaUsed;"minus"===s?t.$Toast("至少选择一件！"):"plus"===s&&t.$Toast(1===a?"库存不足！":"限购"+i+"件！")},handleStepperChange:function(e){var s=t.quota>0,a=0;a=!t.goodsSku.none_sku&&t.sku_selectedComb?t.sku_selectedComb.stock_num:t.countStock;var i=t.quota>a?a:t.quota;t.sku_selectedNum=s?e>i?i:e:e>a?a:e}}}},mounted:function(){this.$refs.load.success(),this.loadData()},methods:{loadData:function(){var t=this,e={};e.goods_id=t.goodsid,Object(L.b)(e).then(function(e){var s=e.data.goods_detail;t.goods_detail=s,t.goodsSku={tree:s.sku.tree?s.sku.tree:[],list:t.tranList,price:s.min_price,stock_num:t.countStock,collection_id:Object(w.s)(s.sku.tree)?t.tranList[0].id:0,none_sku:Object(w.s)(s.sku.tree)},t.goodsInfo={title:s.goods_name,picture:t.$BASESRC(s.goods_images[0])}})},onSku:function(t){this.showSku=!0},onSkuSelect:function(t){this.sku_selectedComb=t.selectedSkuComb},onBuyNow:function(t){var e=this;e.bindMobile().then(function(){var s={sku_list:[]},a={};a.num=e.sku_selectedNum>0?e.sku_selectedNum:1,a.sku_id=t.selectedSkuComb.id,s.sku_list.push(a),e.$router.push({name:"integral-order-confirm",query:{params:Object(B.b)(C()(s))}})})},showShare:function(){this.$store.state.isWeixin?this.isShare=!0:this.$Toast("请点击下方工具栏“分享”按钮进行分享")},closeShare:function(){this.isShare=!1}},components:(q={DetailDescript:O,DetailAttribute:E,PopupShare:N.a},i()(q,k.a.name,k.a),i()(q,y.a.name,y.a),i()(q,b.a.name,b.a),i()(q,f.a.name,f.a),i()(q,v.name,v),i()(q,o.a.name,o.a),q)}),A={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Layout",{ref:"load",staticClass:"integral-goods-detail"},[s("Navbar",{attrs:{title:t.navBarTitle}}),t._v(" "),s("div",{staticClass:"swipe-box",style:t.maxHeight},[s("van-swipe",{staticClass:"swipe",style:t.maxHeight,attrs:{autoplay:3e3}},t._l(t.goods_detail.goods_images,function(e,a){return s("van-swipe-item",{key:a},[s("img",{style:t.maxHeight,attrs:{src:e,onerror:t.$ERRORPIC.noGoods}})])})),t._v(" "),s("div",{staticClass:"box right",on:{click:t.showShare}},[s("van-icon",{attrs:{name:"share"}})],1)],1),t._v(" "),s("van-cell-group",{staticClass:"cell-group"},[s("van-cell",[s("div",{staticClass:"title"},[t._v(t._s(t.goods_detail.goods_name))]),t._v(" "),s("div",{staticClass:"price"},[t.goods_detail.point_exchange?s("span",[t._v(t._s(t.goods_detail.point_exchange)+t._s(t.pointText))]):t._e(),t._v(" "),t.goods_detail.point_exchange&&t.goodsPrice>0?s("span",[t._v("+")]):t._e(),t._v(" "),t.goodsPrice>0?s("span",[t._v(t._s(t._f("yuan")(t.goodsPrice)))]):t._e(),t._v(" "),s("small",{staticClass:"market"},[t._v(t._s(t._f("yuan")(t.goods_detail.min_market_price)))])])]),t._v(" "),s("van-cell",{staticClass:"express"},[s("van-col",{attrs:{span:"10"}},[t._v("运费："+t._s(t.goods_detail.shipping_fee))]),t._v(" "),s("van-col",{attrs:{span:"14"}},[t._v("兑换量："+t._s(t.goods_detail.sales))])],1)],1),t._v(" "),t.goods_detail.day_num>0&&t.goods_detail.limit_num>0?s("van-cell",[s("template",{slot:"title"},[s("van-tag",{attrs:{type:"primary"}},[t._v("限购")]),t._v(" "),s("span",{staticClass:"custom-text"},[t._v("每人限购"+t._s(t.goods_detail.limit_num)+"件，每天提供"+t._s(t.goods_detail.day_num)+"件")])],1)],2):t._e(),t._v(" "),s("van-cell-group",{staticClass:"cell-group"},[s("van-cell",{attrs:{title:t.sku_selectedText,"is-link":""},on:{click:t.onSku}})],1),t._v(" "),s("van-sku",{attrs:{sku:t.goodsSku,goods:t.goodsInfo,"goods-id":t.goods_detail.goods_id,"custom-stepper-config":t.customStepperConfig,quota:t.quota,"close-on-click-overlay":""},on:{"sku-selected":t.onSkuSelect,"buy-clicked":t.onBuyNow},scopedSlots:t._u([{key:"sku-header-price",fn:function(e){return s("div",{},[s("div",{staticClass:"van-sku__goods-price"},[t.goodsPrice&&t.goodsPoint?s("span",[t._v(t._s(t.goodsPoint)+" + "+t._s(t._f("yuan")(t.goodsPrice)))]):t._e(),t._v(" "),t.goodsPoint&&!t.goodsPrice?s("span",[t._v(t._s(t.goodsPoint))]):t._e()])])}},{key:"sku-actions",fn:function(e){return 1===t.goods_state?s("div",{},[s("div",{staticClass:"van-sku-actions"},[s("van-button",{attrs:{type:"primary","bottom-action":""},on:{click:function(t){e.skuEventBus.$emit("sku:buy")}}},[t._v("立即兑换")])],1)]):t._e()}}]),model:{value:t.showSku,callback:function(e){t.showSku=e},expression:"showSku"}}),t._v(" "),s("van-cell-group",{staticClass:"cell-group"},[s("van-tabs",{model:{value:t.tab_active,callback:function(e){t.tab_active=e},expression:"tab_active"}},t._l(t.tabs,function(e,a){return s("van-tab",{key:a,attrs:{title:e.name}},[s("Detail"+e.type,{tag:"component",attrs:{descript:"Descript"==e.type?t.goods_detail.description:"",attribute:"Attribute"==e.type?t.goods_detail.goods_attribute_list?t.goods_detail.goods_attribute_list:[]:""}})],1)}))],1),t._v(" "),null!==t.goods_state?s("van-goods-action",{staticClass:"goods-action-group"},[s("van-goods-action-mini-btn",{attrs:{icon:"wap-home",text:"首页",to:"/integral/index"}}),t._v(" "),1===t.goods_state?s("van-goods-action-big-btn",{staticClass:"action-btn btn-buy",attrs:{text:"立即兑换"},on:{click:function(e){t.onSku("buy")}}}):t._e(),t._v(" "),1!==t.goods_state?s("van-goods-action-big-btn",{staticClass:"action-btn",attrs:{disabled:"",text:t.goods_state_text}}):t._e()],1):t._e(),t._v(" "),s("PopupShare",{attrs:{isShow:t.isShare},nativeOn:{click:function(e){return t.closeShare(e)}}})],1)},staticRenderFns:[]};var M=s("VU/8")(F,A,!1,function(t){s("US8J")},"data-v-4d5a79b8",null);e.default=M.exports},US8J:function(t,e){},a3FQ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("eKM9"),i=s("muf+"),o=s("NiMi"),n=Object(a.a)({name:"integral-index",data:function(){return{page:{},items:{}}},computed:{navbarTitle:function(){var t=this.page.title;return t&&(document.title=t),t}},activated:function(){this.navbarTitle&&(document.title=this.navbarTitle),this.$store.state.config.addons.integral?(this.getCustom(),this.$refs.load.success()):this.$refs.load.fail({errorText:"未开启积分商城应用",showFoot:!1})},methods:{getCustom:function(){var t=this;this.$store.dispatch("getCustom",{type:9}).then(function(e){e.template_data&&(t.items=e.template_data.items,t.page=e.template_data.page)})}},components:{InviteWechat:i.a,CustomGroup:o.a}}),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("Layout",{ref:"load",staticClass:"integral-index"},[e("Navbar",{attrs:{title:this.navbarTitle}}),this._v(" "),e("InviteWechat"),this._v(" "),e("CustomGroup",{attrs:{type:"9",items:this.items}})],1)},staticRenderFns:[]};var c=s("VU/8")(n,r,!1,function(t){s("KX41")},"data-v-66e5299e",null);e.default=c.exports},aLJN:function(t,e){},"cn+8":function(t,e){},e89B:function(t,e,s){"use strict";var a=s("WPoX"),i=s("AA6R"),o=s.n(i),n=s("o69Z"),r=s("+2ln"),c=s("rhik"),d=s("n8HW"),u=Object(n.k)("goods-action-mini-btn"),l=u[0],_=u[1];function p(t,e,s,a){return t("div",o()([{class:[_(),"van-hairline"],on:{click:function(t){Object(c.a)(a,"click",t),Object(d.a)(a)}}},Object(c.b)(a)]),[t(r.a,{class:[_("icon"),e.iconClass],attrs:{tag:"div",info:e.info,name:e.icon}}),s.default?s.default():e.text])}p.props=Object(a.a)({},d.c,{text:String,icon:String,info:[String,Number],iconClass:null}),e.a=l(p)},mZBS:function(t,e){},pzvz:function(t,e,s){"use strict";var a=s("AA6R"),i=s.n(a),o=s("o69Z"),n=s("rhik"),r=Object(o.k)("goods-action"),c=r[0],d=r[1];function u(t,e,s,a){return t("div",i()([{class:d({"safe-area-inset-bottom":e.safeAreaInsetBottom})},Object(n.b)(a,!0)]),[s.default&&s.default()])}u.props={safeAreaInsetBottom:Boolean},e.a=c(u)},sJM5:function(t,e){},wIB1:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("bOdI"),i=s.n(a),o=(s("10Qn"),s("UQoe")),n=s("eKM9"),r=s("OQ2V"),c={data:function(){return{}},props:{id:[String,Number],tag:String,desc:String,thumb:String,title:String,centered:Boolean,lazyLoad:Boolean,thumbLink:String,num:[Number,String],price:[Number,String],exchange:[Number,String],coupon:String,giftvoucher:String,balance:[Number,String],currency:{type:String,default:"¥"},goodsType:[String,Number]},computed:{pointText:function(){return this.$store.state.member.memberSetText.point_style}},methods:{click:function(){this.id?this.$router.push("/integral/goods/detail/"+this.id):this.thumbLink&&this.$router.push(this.thumbLink)}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("div",{staticClass:"card__header"},[t.thumb||t.$slots.thumb?s("div",{staticClass:"card__thumb",on:{click:t.click}},[t._t("thumb",[t.lazyLoad?s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.thumb,expression:"thumb"}],key:t.thumb,staticClass:"card__img",attrs:{"pic-type":"square"}}):s("img",{staticClass:"card__img",attrs:{src:t.thumb,onerror:t.$ERRORPIC.noSquare}})]),t._v(" "),t.tag?s("van-tag",{staticClass:"tag tag--mark card__tag",attrs:{mark:"",type:"danger"}},[t._v(t._s(t.tag))]):t._e()],2):t._e(),t._v(" "),s("div",{staticClass:"card__content"},[t._t("title",[t.title?s("div",{staticClass:"card__title",on:{click:t.click}},[t._v(t._s(t.title))]):t._e()]),t._v(" "),t._t("desc",[t.desc?s("div",{staticClass:"card__desc ellipsis"},[t._v(t._s(t.desc))]):t._e()]),t._v(" "),t._t("coupon",[t.coupon?s("div",{staticClass:"card__desc ellipsis"},[t._v(t._s(t.coupon))]):t._e()]),t._v(" "),t._t("giftvoucher",[t.giftvoucher?s("div",{staticClass:"card__desc ellipsis"},[t._v(t._s(t.giftvoucher))]):t._e()]),t._v(" "),t._t("balance",[t.balance&&"0.00"!==t.balance?s("div",{staticClass:"card__desc ellipsis"},[t._v(t._s(t.balance))]):t._e()]),t._v(" "),t._t("tags"),t._v(" "),s("div",{staticClass:"card__bottom"},[t.$slots.bottomRight?s("div",{staticClass:"card__price-group"},[t.price>0&&t.exchange?s("div",{staticClass:"card__price"},[t._v(t._s(t.currency)+" "+t._s(t.price)+" + "+t._s(t.exchange)+t._s(t.pointText))]):s("div",{staticClass:"card__price"},[t._v(t._s(t.exchange)+t._s(t.pointText))])]):t._e(),t._v(" "),t.$slots.bottomRight?t._t("bottomRight"):t._e()],2)],2)]),t._v(" "),t.$slots.footer?s("div",{staticClass:"card__footer"},[t._t("footer")],2):t._e()])},staticRenderFns:[]};var u=s("VU/8")(c,d,!1,function(t){s("E2ca")},"data-v-378668dd",null).exports,l=s("mvHQ"),_=s.n(l),p=s("p+v9"),h=s("BuIE"),m=s("oFuF"),g={props:{items:[Object,Array],goodsType:[String,Number],shippingType:[String,Number],address:[Object,Array]},data:function(){return{type:null,pay_type:0,isLoading:!1}},watch:{goodsType:function(t){return this.id}},computed:{pay_total_amount:function(){var t=0;return(this.items?this.items:[]).forEach(function(e){var s=e.total_amount;t+=s<=0?0:s}),t.toFixed(2)},pay_total_point:function(){var t=0;return(this.items?this.items:[]).forEach(function(e){var s=e.total_point;t+=s<=0?0:s}),t},order_data:function(){var t=this.items,e={order_data:{}},s=e.order_data;return s.custom_order="",s.type=this.$store.state.isWeixin&&this.$store.getters.config.is_wchat?1:2,s.goods_type=this.goodsType,s.pay_type=this.pay_type,0==this.goodsType&&(s.address_id=this.address.id),s.leave_message="",s.shipping_type=this.shippingType,this.pay_total_point&&this.pay_total_amount>0?s.point_exchange_type=2:s.point_exchange_type=1,s.goods_list={},s.goods_list.exchange_point=this.pay_total_point?this.pay_total_point:"",t?(this.items.forEach(function(t){t.goods_list.forEach(function(t){s.goods_list.goods_id=t.goods_id,s.goods_list.sku_id=t.sku_id?t.sku_id:"",s.goods_list.num=t.num,s.goods_list.price=t.price?t.price:""})}),e):{}}},mounted:function(){},methods:{toPopup:function(){if(0==this.goodsType&&!this.order_data.order_data.address_id)return this.$Toast("请添加地址！"),!1;if(this.pay_total_point&&this.pay_total_amount>0){var t=Object(h.b)(_()(this.order_data));Object(m.t)()?location.replace(this.$store.state.domain+"/wap/pay/payment?order_data="+t+"&pay_money="+this.pay_total_amount+"#integral"):this.$router.push({name:"pay-payment",query:{order_data:t,pay_money:this.pay_total_amount},hash:"#integral"})}else this.pay_type=0,this.createPayOrder()},createPayOrder:function(){var t=this;t.type;Object(p.f)(t.order_data).then(function(e){t.$router.replace({name:"pay-result",query:{is_integral_order:1,pay_status:2}})})}}},v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"submit-pay-wrap"},[e("div",{staticClass:"btn-submit-pay"},[e("div",{staticClass:"btn-submit-pay-wrap"},[e("van-button",{staticClass:"action-btn",attrs:{square:"",size:"large",type:"danger"},on:{click:this.toPopup}},[this._v("立即支付")])],1)])])},staticRenderFns:[]};var f=s("VU/8")(g,v,!1,function(t){s("cn+8")},"data-v-19a6571d",null).exports,b=(s("9GaH"),Object(n.a)({name:"integral-order-confirm",data:function(){JSON.parse(Object(h.a)(this.$route.query.params));return{goodsType:0,address:{},items:[],shipping_type:1,orderData:{}}},filters:{filterSpec:function(t){if(Object(m.s)(t))return"";var e=[];return t.forEach(function(t){var s=t.spec_name+" "+t.spec_value_name;e.push(s)}),e.join(" , ")}},computed:{params:{get:function(){return JSON.parse(Object(h.a)(this.$route.query.params))},set:function(t){console.log(t)}},pointText:function(){return this.$store.state.member.memberSetText.point_style},isGoodsType:function(){return 0==this.goodsType},cellShippingText:function(){return"配送方式"}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;Object(p.e)(t.params).then(function(e){var s=e.data;t.items=s.shop.map(function(t){return t}),Object(m.s)(s.address)||(t.address={name:s.address.consigner,tel:s.address.mobile,id:s.address.address_id,address:s.address.province_name+s.address.city_name+s.address.district_name+s.address.address_detail}),t.goodsType=t.items[0].goods_list[0].goods_exchange_type,t.$refs.load.success()}).catch(function(){t.$store.getters.isBingFlag&&t.$store.getters.isBindMobile?t.$refs.load.fail():t.$refs.load.result()})},onAddress:function(t){this.address=t,this.params.address_id=t.id,this.loadData()},cellShippingValue:function(t){var e=t.shipping_fee,s="快递 ¥"+e;return 0==parseFloat(e)&&(s="快递 包邮"),1!=this.isGoodsType||void 0!=e&&null!=e?0!=this.isGoodsType||void 0!=e&&null!=e||(s="快递 包邮"):s="未选择收货地址",s},onStepperChange:function(t){this.params;this.$Toast.loading({forbidClick:!0,duration:0}),this.$Toast.clear(),this.loadData()}},components:i()({ChoiceAddress:r.a,GoodsCard:u,SubmitPay:f},o.a.name,o.a)})),y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Layout",{ref:"load",staticClass:"integral-order-confirm"},[s("Navbar",{attrs:{isMenu:!1}}),t._v(" "),t.isGoodsType?s("ChoiceAddress",{attrs:{address:t.address},on:{select:t.onAddress}}):t._e(),t._v(" "),t.items?s("div",{staticClass:"list"},t._l(t.items,function(e,a){return s("van-cell-group",{key:a,staticClass:"items card-group-box"},[t._l(e.goods_list,function(e){return s("van-cell",{key:e.goods_id},[s("GoodsCard",{attrs:{title:e.goods_name,desc:t._f("filterSpec")(e.spec),coupon:e.coupon.coupon_name,giftvoucher:e.gift_voucher.gift_voucher_name,balance:e.balance,price:e.price,exchange:e.point_exchange,thumb:t._f("BASESRC")(e.goods_pic),goodsType:t.goodsType}},[s("div",{staticClass:"tags",attrs:{slot:"bottomRight"},slot:"bottomRight"},[s("van-stepper",{staticClass:"stepper-box",attrs:{integer:"","disable-input":"",max:0===e.max_buy?e.stock:e.stock>e.max_buy?e.max_buy:e.stock},on:{change:t.onStepperChange},model:{value:t.params.sku_list[0].num,callback:function(e){t.$set(t.params.sku_list[0],"num",e)},expression:"params.sku_list[0].num"}})],1)])],1)}),t._v(" "),s("van-cell",{staticClass:"cell-right-text",attrs:{title:t.cellShippingText,value:t.cellShippingValue(e)}}),t._v(" "),s("van-cell",[s("div",{staticClass:"foot"},[t._v("\n          共 \n          "),s("span",[t._v(t._s(e.goods_list.length))]),t._v(" 件商品   小计：\n          "),e.total_point&&e.total_amount>0?s("span",{staticClass:"price"},[t._v(t._s(e.total_point)+t._s(t.pointText)+" + "+t._s(t._f("yuan")(e.total_amount)))]):s("span",{staticClass:"price"},[t._v(t._s(e.total_point)+t._s(t.pointText))])])])],2)})):t._e(),t._v(" "),s("SubmitPay",{attrs:{items:t.items,goodsType:t.goodsType,shippingType:t.shipping_type,address:t.address}})],1)},staticRenderFns:[]};var k=s("VU/8")(b,y,!1,function(t){s("0Qt4")},"data-v-49a2037d",null);e.default=k.exports},zTEI:function(t,e,s){"use strict";var a=s("nsZj"),i=(s.n(a),s("CjYO"));s.n(i)}});