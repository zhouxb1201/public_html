webpackJsonp([22],{"2RH7":function(t,e){},CHmA:function(t,e,a){"use strict";e.c=function(t){return Object(i.a)({url:"/addons/giftvoucher/giftvoucher/userGiftvoucher",method:"post",data:t})},e.a=function(t){return Object(i.a)({url:"/addons/giftvoucher/giftvoucher/userGiftvoucherInfo",method:"post",data:{record_id:t}})},e.e=function(t){return Object(i.a)({url:"/addons/giftvoucher/giftvoucher/giftvoucherReceive",method:"post",data:t,isWriteIn:!0})},e.b=function(t){return Object(i.a)({url:"/addons/giftvoucher/giftvoucher/giftvoucherDetail",method:"post",data:{gift_voucher_id:t}})},e.d=function(t){return Object(i.a)({url:"/addons/giftvoucher/giftvoucher/giftvoucherStore",method:"post",data:t})};var i=a("vLgD")},JzXb:function(t,e){},KBjh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("eKM9"),s=a("n/o4"),o=a("QGCa"),n=a("CHmA"),r=Object(i.a)({name:"giftvoucher-detail",data:function(){return{detail:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;Object(n.a)(t.$route.params.recordid).then(function(e){var a=e.data;t.detail=a,t.$refs.load.success()}).catch(function(){t.$refs.load.fail()})}},components:{InfoItem:s.a,CodeBox:o.a}}),c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{ref:"load",staticClass:"giftvoucher-detail bg-f8"},[a("Navbar"),t._v(" "),a("InfoItem",{class:1==t.detail.state?"usable":"unusable",attrs:{items:t.detail}}),t._v(" "),a("CodeBox",{attrs:{qrcode:t.detail.gift_voucher_codeImg,code:t.detail.gift_voucher_code}}),t._v(" "),a("van-cell",[a("div",{staticClass:"cell"},[a("div",{staticClass:"text-maintone"},[t._v("使用时间")]),t._v(" "),a("div",[t._v(t._s(t._f("formatDate")(t.detail.start_time))+" ~ "+t._s(t._f("formatDate")(t.detail.end_time)))])]),t._v(" "),a("div",{staticClass:"cell"},[a("div",{staticClass:"text-maintone"},[t._v("使用说明")]),t._v(" "),a("div",[t._v(t._s(t.detail.desc))])])])],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(t){a("2RH7")},"data-v-6e8702b4",null);e.default=d.exports},T1Rv:function(t,e){},b99D:function(t,e){},jtp3:function(t,e){},mxSt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("eKM9"),s=a("CHmA"),o=a("msXN"),n={props:{detail:Object},mixins:[o.a],computed:{isDisabled:function(){var t=!1;return 0!=this.detail.is_giftvoucher&&-1!=this.detail.is_giftvoucher&&-2!=this.detail.is_giftvoucher||(t=!0),t},isDisGray:function(){var t="";return 0!=this.detail.is_giftvoucher&&-1!=this.detail.is_giftvoucher&&-2!=this.detail.is_giftvoucher||(t="#999"),t},isDisBack:function(){var t="";return 0!=this.detail.is_giftvoucher&&-1!=this.detail.is_giftvoucher&&-2!=this.detail.is_giftvoucher||(t="backcr-e8"),t},giftvoucherStateText:function(){var t="";return 0==this.detail.is_giftvoucher?t="已领取":this.detail.is_giftvoucher>0?t="立即领取":-1==this.detail.is_giftvoucher?t="未开始":-2==this.detail.is_giftvoucher&&(t="已过期"),t}},methods:{onReceive:function(){var t=this,e={};e.gift_voucher_id=t.detail.gift_voucher_id,e.get_type=1,Object(s.e)(e).then(function(e){e.code>0?(t.detail.is_giftvoucher=0,t.$Toast.success("领取成功")):t.$Toast.success("领取失败")})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"head-receive"},[a("div",{staticClass:"head"},[a("div",{staticClass:"info"},[a("div",{staticClass:"shop-img"},[a("img",{attrs:{src:t.detail.shop_logo,onerror:t.$ERRORPIC.noAvatar}})]),t._v(" "),a("p",{staticClass:"shop-name"},[t._v(t._s(t.detail.shop_name))]),t._v(" "),a("p",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(t.detail.start_time))+" ~ "+t._s(t._f("formatDate")(t.detail.end_time)))]),t._v(" "),a("div",{staticClass:"giftvoucher-wrap",style:{color:t.isDisGray}},[a("div",{staticClass:"img"},[a("img",{attrs:{src:t.detail.pic_cover_mid?t.detail.pic_cover_mid:"",onerror:t.$ERRORPIC.noGoods}})]),t._v(" "),a("div",{staticClass:"explain"},[a("p",[t._v(t._s(t.detail.giftvoucher_name))])]),t._v(" "),a("div",{staticClass:"btn"},[a("van-button",{staticClass:"btn",class:t.isDisBack,attrs:{size:"small",round:"",disabled:t.isDisabled,type:"danger"},on:{click:function(e){t.bindMobile("onReceive")}}},[t._v(t._s(t.giftvoucherStateText))])],1)])])])])},staticRenderFns:[]};var c=a("VU/8")(n,r,!1,function(t){a("T1Rv")},"data-v-b3570464",null).exports,d=Object(i.a)({name:"giftvoucher-receive",data:function(){return{detail:{},params:{page_index:1,page_size:20}}},mixins:[o.e],filters:{distance:function(t){return 1e3*t+"m"}},mounted:function(){var t=this;this.loadData(),this.$store.dispatch("getBMapLocation").then(function(e){var a=e.location;t.params.lng=a.lng,t.params.lat=a.lat,t.loadList("init")}).catch(function(e){t.$Toast({message:e+"将显示所有门店",duration:3e3}),t.loadList("init")})},methods:{loadData:function(){var t=this;Object(s.b)(t.$route.params.giftvoucherid).then(function(e){var a=e.data;t.detail=a,t.$refs.load.success()}).catch(function(){t.$refs.load.fail()})},loadList:function(t){var e=this;t&&"init"===t&&e.initList(),e.params.gift_voucher_id=e.$route.params.giftvoucherid,Object(s.d)(e.params).then(function(a){var i=a.data,s=i.store_list?i.store_list:[];e.pushToList(s,i.page_count,t)}).catch(function(){e.loadError()})}},beforeDestroy:function(){var t=document.getElementsByTagName("iframe")[0];t&&t.remove()},components:{ReceiveHeadInfo:c}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{ref:"load",staticClass:"giftvoucher-receive bg-ff454e"},[a("Navbar"),t._v(" "),a("ReceiveHeadInfo",{attrs:{detail:t.detail}}),t._v(" "),a("div",{staticClass:"apply-store-wrap"},[a("h3",[t._v("适用门店")]),t._v(" "),a("div",{staticClass:"apply-store-main"},[a("List",{attrs:{finished:t.finished,error:t.error},on:{"update:error":function(e){t.error=e},load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e,i){return a("div",{key:i,staticClass:"store-li"},[a("section",{staticClass:"store-li-theme"},[a("span",[t._v(t._s(e.store_name))]),t._v(" "),a("span",[t._v(t._s(t._f("distance")(e.distance)))])]),t._v(" "),a("van-cell",{attrs:{title:e.address,icon:"location-o"}})],1)}))],1)])],1)},staticRenderFns:[]};var u=a("VU/8")(d,l,!1,function(t){a("JzXb")},"data-v-e0d5f534",null);e.default=u.exports},"n/o4":function(t,e,a){"use strict";var i={props:{items:Object}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item"},[a("div",{staticClass:"info"},[a("div",{staticClass:"img"},[a("img",{attrs:{src:t.items.pic_cover_mid,onerror:t.$ERRORPIC.noSquare}})]),t._v(" "),a("div",{staticClass:"text"},[a("div",{staticClass:"name"},[t._v(t._s(t.items.giftvoucher_name))]),t._v(" "),a("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(t.items.start_time))+" ~ "+t._s(t._f("formatDate")(t.items.end_time)))]),t._v(" "),a("div",{staticClass:"detail"},[t._t("foot")],2)])]),t._v(" "),1!=t.items.state?a("div",{staticClass:"icon-bg"},[a("van-icon",{attrs:{name:2==t.items.state?"v-icon-coupon-use":"v-icon-overdue"}})],1):t._e()])},staticRenderFns:[]};var o=a("VU/8")(i,s,!1,function(t){a("b99D")},"data-v-70ab3259",null);e.a=o.exports},sRwQ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("eKM9"),s=a("ORU3"),o=a("n/o4"),n=a("CHmA"),r=a("msXN"),c=Object(i.a)({name:"giftvoucher-list",data:function(){return{tab_active:0,tabs:[{name:"未使用",status:1},{name:"已使用",status:2},{name:"已过期",status:3}],params:{state:1}}},mixins:[r.e],mounted:function(){this.loadList()},methods:{onTab:function(t){var e=this.tabs[t].status;this.params.state=e,this.loadList("init")},loadList:function(t){var e=this;t&&"init"===t&&e.initList(),Object(n.c)(e.params).then(function(a){var i=a.data,s=i.data;e.pushToList(s,i.page_count,t)}).catch(function(){e.loadError()})}},components:{HeadTab:s.a,InfoItem:o.a}}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"giftvoucher-list bg-f8"},[a("Navbar"),t._v(" "),a("HeadTab",{attrs:{tabs:t.tabs},on:{"tab-change":t.onTab},model:{value:t.tab_active,callback:function(e){t.tab_active=e},expression:"tab_active"}}),t._v(" "),a("List",{staticClass:"list",attrs:{finished:t.finished,error:t.error,"is-empty":t.isListEmpty,empty:{top:t.$store.state.isWeixin?46:90}},on:{"update:error":function(e){t.error=e},load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e,i){return a("InfoItem",{key:i,attrs:{items:e}},[a("router-link",{staticClass:"a-link e-handle fs-12",attrs:{slot:"foot",to:"/giftvoucher/detail/"+e.record_id},slot:"foot"},[t._v("详情 ▶")])],1)}))],1)},staticRenderFns:[]};var l=a("VU/8")(c,d,!1,function(t){a("jtp3")},"data-v-1ba5e5a6",null);e.default=l.exports}});