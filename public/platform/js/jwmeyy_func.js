function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function init(t){function e(t){l.forEach(function(e){var i=e.dataset["function"];i===t?(e.classList.add("active"),a.setFunction(planeFunctions[t])):e.classList.remove("active")})}function i(t){p.forEach(function(e){var i=e.dataset.rotate;i===t&&(e.classList.toggle("active"),a.toggleRotate(i))})}var n=t.getContext("2d"),o=new F3.Scene,r=new F3.Camera;r.origin=new F3.Vector3(t.width/2,t.height/3),r.p=1200;var s=new F3.Renderer(n,t),a=new Effect(s,o,r,t);a.animate();var c=document.querySelector(".functions_canvas"),u="";for(var h in planeFunctions)u+='<div class="btn_canvas" data-function="'+h+'">'+h+"</div>";c.innerHTML=u;var l=c.querySelectorAll(".btn_canvas");e(l[0].dataset["function"]),c.addEventListener("click",function(t){t.target.dataset["function"]&&e(t.target.dataset["function"])});var f=document.querySelector(".rotate"),p=f.querySelectorAll(".btn_canvas");i("y"),f.addEventListener("click",function(t){t.target.dataset.rotate&&i(t.target.dataset.rotate)}),F3.TIME.start()}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Point=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.radius=t,i.color="rgba("+[255*Math.random()|0,255*Math.random()|0,255*Math.random()|0,Math.random()].join(",")+")",i.prevCrood=null,i}return _inherits(e,t),_createClass(e,[{key:"render",value:function(t){t.fillStyle="#fff",t.fillRect(this.croods2D.position.x,this.croods2D.position.y,this.radius*this.croods2D.scale*this.yScale,this.radius*this.croods2D.scale*this.yScale)}}]),e}(F3.Obj),planeFunctions={"sin(sqrt(x^2+z^2))":function(t,e,i){return Math.sin(Math.sqrt(Math.pow(t/2,2)+Math.pow(e/2,2))-i)},"cos(x)*sin(z)":function(t,e,i){return Math.cos(t/4+i)*Math.sin(e/4+i)*1}},Effect=function(t){function e(t,i,n,o){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.renderer=t,r.scene=i,r.camera=n,r.cvs=o,r.xOffset=0,r.waveHeight=.4,r.waveWidth=8,r.col=33,r.colPointNum=33,r.flyTime=2e3,r.timePass=0,r.scale=1,r.scaleStep=.01,r.planeFunction=function(){return 0},r.rotate={x:!1,y:!1,z:!1},r.pointGroup=new F3.Obj,r.scene.add(r.pointGroup),r.resize(o.width,o.height),r.init(),r}return _inherits(e,t),_createClass(e,[{key:"resize",value:function(t,e){this.cvs.width=t,this.cvs.height=e,this.stepWidth=1.8*t/this.col,this.pointGroup.setPosition(this.cvs.width/2,1.2*this.cvs.height,-this.col*this.stepWidth/2),this.pointGroup.setRotation(.1,0,0)}},{key:"init",value:function(){for(var t,e=-(this.col-1)/2;e<=(this.col-1)/2;e++)for(var i=-(this.colPointNum-1)/2;i<=(this.colPointNum-1)/2;i++)t=new Point(10),this.pointGroup.add(t),t.initPos=new F3.Vector3(0,0,0),t.flyDelay=0}},{key:"update",value:function(t){this.timePass+=t,this.xOffset=this.timePass/500;var e=void 0,i=void 0,n=void 0,o=void 0,r=void 0,s=0;for(n=-(this.col-1)/2;n<=(this.col-1)/2;n++)for(r=-(this.colPointNum-1)/2;r<=(this.colPointNum-1)/2;r++)o=this.planeFunction(n,r,this.xOffset),e=this.pointGroup.children[s],e.yScale=1,i=(this.timePass-e.flyDelay)/this.flyTime,i=i>1?1:i<0?0:i,e.setPosition(n*this.stepWidth,o*this.stepWidth,r*this.stepWidth),s++;(this.rotate.x||this.rotate.y||this.rotate.z)&&this.pointGroup.setRotation(this.rotate.x?this.pointGroup.rotation.x+.001:0,this.rotate.y?this.pointGroup.rotation.y+.001:0,this.rotate.z?this.pointGroup.rotation.z+.001:0)}},{key:"setFunction",value:function(t){this.planeFunction=t}},{key:"toggleRotate",value:function(t){this.rotate[t]=!this.rotate[t],this.rotate[t]||(this.pointGroup.rotation[t]=0)}},{key:"animate",value:function(){var t=this;this.addTick(function(e){t.update(e),t.renderer.render(t.scene,t.camera)})}}]),e}(F3.Time);init(document.querySelector("canvas"));